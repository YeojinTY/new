<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulator</title>
    <style>
      body{
       
        background-color:grey;
        
      }
    
.header {
                    overflow: hidden;
                    padding: 20px;
                    text-align: center;
                    line-height: 800px;
                    width: -100%;
                    height: 800px;
                    background-color: pink;

}
/* .nav{
    float:left;
} */
#eff{
    
    width: 15%; height: 50px; 
    position:absolute; 
    margin: 20px 30px 20px 30px; 
    margin-left: 800px;
    margin-top: 50px;
    text-emphasis: none;
    text-align: center; line-height: 50px;
    background-color: #ffffff63;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    text-decoration: none;


}
#DoDoDO{
    width: 15%; height: 50px; 
    position: absolute; 
    margin: 20px 40px 20px 40px; 
    margin-left: 300px;
    margin-top: 50px;
    text-emphasis: none;
    text-align: center; line-height: 50px;
    background-color: #ffffff63;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    text-decoration: none;
}

/*-----------------------------------------여기서 부터 컨테이너-----------------------------*/
.container {
    background-color: #ffffff63;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    padding: 40px;
    margin-bottom: 20px;
    margin-top: 150px;
   
  }
   .item-image {
    max-width: 400px;
    max-height: 500px;
    width: 40%; height: 400px;
    background-color: aliceblue;
    overflow: hidden;
    margin-top: 50px;

  } 

  .pp{
            flex-direction: column;
            margin-left: 430px;
            margin-top: -450px;
        
        #itemName{
            width: 15%;
            height: 50%;
            background-color:  pink;
            text-align: center;
            margin-left: 150px;
            

        }
        .item-description{
            width: 43%;
            height: 30%;
            background-color: greenyellow;
            text-align: center;
            line-height: 100px;
            overflow: hidden;
        }
        .percentage{
            width: 43%;
            height: 300px;
            background-color: grey;
            overflow: hidden;
        
        }

        .ppI{
            float:left;
            width: 150px;
            height: 100px;
            background-color: aliceblue;
            margin: 0px 3px ;
            padding:10px;
            border: 1px solid black;
            margin: 0 auto;
            margin-left: 100px;
            margin-top: 10px;
            text-align: center;
            line-height: 100px;
            

        }
  }

.btn btn-primary{
  width: 100px; height: 200px;
  margin-left: 500px;
}
  .success-text {color: green;}
  .failure-text {color: red;}        
  .star-rating {
  display: flex;
  justify-content: center;
  /* 별점을 가운데 정렬 */}

  .btn btn-primary{
    background-color: salmon;
    width: 200px; height: 150px;
    padding: 10px 30px;
  }

  .star {
        appearance: none;
        padding: 1px;
    }

    .star::after {
        content: '☆';
        color: rgb(255, 247, 0);
        font-size: 20px;
    }

    .star-rating .star:hover::after,
    .star-rating .star:has(~ .star:hover)::after,
    .star-rating .star:checked::after,
    .star-rating .star:has(~ .star:checked)::after {
        content: '★';
    }

    .star:hover~.star::after {
        content: '☆';
    }

    .star {
        color: blue;
        /* 매기는 별점 색상 */
    }

    .footer .star {
        color: red;
        /* 댓글에 대한 별점 색상 */
    }

    .footer #average-rating {
        color: red;
        font-size: 24px;
    }

</style>
<style></style>
<style>
    /* 기존 스타일 유지 */
  
    /* 댓글에 테두리 스타일 추가 */
    #comments-list li {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
    }
  </style>
  <style>
    /* 평가 및 리뷰 영역 전체적인 스타일 */
.footer {
  padding: 20px;
  background-color: #f9f9f9;
  border: 1px solid #ccc; /* 테두리 스타일 추가 */
  border-radius: 10px; /* 테두리 둥글게 만듦 */
  margin-top:500px;
}

/* 평가 및 리뷰 제목 스타일 */
.footer h3 {
  font-size: 24px;
  color: #333;
  margin-bottom: 10px;
  margin-left: 45%;
}

/* 별점 평가 폼 스타일 */
.rating-form-table {
  margin-bottom: 20px;
}

/* 별점 선택 영역 스타일 */
.star-rating {
  display: flex;
  justify-content: center;
  margin-bottom: 10px;
  margin-left: 240px;
 
}

/* 별점 스타일 */
.star {
  appearance: none;
  padding: 1px;
  
}

.star::after {
  content: '☆';
  color: rgb(218, 84, 23);
  font-size: 20px;


}

/* 별점 선택 시 스타일 */
.star-rating .star:hover::after,
.star-rating .star:has(~ .star:hover)::after,
.star-rating .star:checked::after,
.star-rating .star:has(~ .star:checked)::after {
  content: '★';
}

.star:hover~.star::after {
  content: '☆';
}

.star {
  color: blue;
}

.footer .star {
  color: red;
}

/* 별점 평가 버튼 스타일 */
.rating-form-table button {
  padding: 8px 15px;
  background-color: #007bff;
  color: white;
  border: none;
  cursor: pointer;
  border-radius: 5px;
  
}

.rating-form-table button:hover {
  background-color: #0056b3;
}

/* 이름 및 비밀번호 입력란 스타일 */
.rating-form-table input[type="text"],
.rating-form-table input[type="password"],
.rating-form-table textarea {
  width: 100%;
  padding: 8px;
  margin: 5px 0;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}

/* 댓글 입력란 스타일 */
.rating-form-table textarea {
  height: 100px;
}

/* 댓글 작성 및 삭제 버튼 스타일 */
.rating-form-table button[type="button"] {
  padding: 8px 15px;
  background-color: #28a745;
  color: white;
  border: none;
  cursor: pointer;
  border-radius: 5px;
}

.rating-form-table button[type="button"]:hover {
  background-color: #218838;
}

/* 댓글 목록 스타일 */
#comments-list {
  list-style: none;
  padding: 0;
}

#comments-list li {
  border: 1px solid #ccc;
  padding: 10px;
  margin-bottom: 10px;
}

/* 각 댓글의 이름 스타일 */
#comments-list li span.comment-name {
  font-weight: bold;
}

/* 각 댓글의 시간 스타일 */
#comments-list li span.comment-time {
  color: #666;
  font-size: 12px;
}

/* 수정 및 삭제 버튼 스타일 */
#comments-list li button {
  padding: 5px 10px;
  margin-left: 5px;
  background-color: #dc3545;
  color: white;
  border: none;
  cursor: pointer;
  border-radius: 5px;
}

#comments-list li button:hover {
  background-color: #c82333;
}
    
        
  </style>
</head>
<body>
    <div class="header">
        <h1>강화 시뮬레이션:여기에 로고, 이미지 삽입</h1>
      </div>

     
        <a href="#" id="eff">강화하기</a>
        <a href="#" id="DoDoDO">도감</a>
      
        <div class="container">
            <div class="row">
              <div class="col-md-6">
                <img src="도시락.png" alt="강화 아이템" class="item-image" id="itemImage"  >
              </div>

              <div class="pp">
                <h1 class="item-title" id="itemName">NAME</h1> 
            
                <p class="item-description" >
                    item-description</p>
            
                <div class="percentage">
                 <p>
                  <span class="ppI">성공 확률: 80%</span> <br>
                  <span class="ppI">실패 확률: 20%</span>
                </p>
            
                
              </div> 
      </div>

      <button class="btn btn-primary" type="button" onclick="enhance()" id="enhanceButton">강화하기</button>
      <span id="successCount" class="enhancement-count"></span> 

   <div class="footer"> 
      <h3>평가 및 리뷰</h3>
       <table class="rating-form-table">
          <tr>
             <td>
               <label for="rating">별점을 선택해 주세요.</label><br>
                  </td>
                  <td>
                   <div class="star-rating">
                      <input type="radio" class="star" value="1" name="rating">
                      <input type="radio" class="star" value="2" name="rating">
                      <input type="radio" class="star" value="3" name="rating">
                      <input type="radio" class="star" value="4" name="rating">
                      <input type="radio" class="star" value="5" name="rating">
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><label for="name">이름:</label></td>
                  <td><input type="text" id="name" name="name"></td>
                  <td><label for="password">비밀번호:</label></td>
                  <td><input type="password" id="password" name="password"></td>
                  <td><button type="button" onclick="saveRatingAndComment()">작성하기</button></td>
                </tr>
                <tr>
                  <td><label for="comment">댓글</label></td>
                  <td colspan="4"><textarea id="comment" name="comment" placeholder="댓글을 입력하세요."></textarea></td>
                </tr>
              </table>
          
              <!-- 별점과 코멘트를 표시할 영역 -->
              <div id="rating-comments">
                <div id="average-rating"></div>
                <ul id="comments-list"></ul>
              </div>
              </form>
  </div>





            <script>
              var successCount = 0;
              var successRate = 0.8; // 초기 성공 확률
              var failureRate = 0.2; // 초기 실패 확률
              
              function enhance() {
                var random = Math.random(); // 0과 1 사이의 랜덤한 숫자 생성
                var successCountElement = document.getElementById("successCount");
                var successRateElement = document.getElementById("successRate");
                var failureRateElement = document.getElementById("failureRate");
                var enhanceButton = document.getElementById("enhanceButton");
                var enchanceRateElement = document.getElementById("enchanceRate")
              
                if (successCount < 5) {
                  if (random < successRate) {
                    // 성공할 때
                    successCount++;
                    successCountElement.innerHTML = "<span class='success-text'>성공+</span>" + successCount;
                  } else {
                    // 실패할 때
                    successCount = 0; // 숫자 초기화
                    successCountElement.innerHTML = "<span class='failure-text'>실패</span>";
                  }
                } else {
                  if (document.getElementById("itemImage").src.includes("sword.jpg")) 
                  {// 검이 +5로 강화됐을 때 총으로 바뀌어서 강화 단계를 다시 초기화
                    document.getElementById("itemImage").src = "gun.jpg";
                    document.getElementById("itemName").innerHTML = "총";
                    successRate = 0.7; // 성공 확률 변경
                    failureRate = 0.3; // 실패 확률 변경
                    successRateElement.textContent = "성공 확률: 70%";
                    failureRateElement.textContent = "실패 확률: 30%";
                    successCountElement.innerHTML = "<span class='success-text'>총으로 변환!</span>";} 
                  else if (document.getElementById("itemImage").src.includes("gun.jpg")) {
                    // 총이 +5로 강화됐을 때 로켓으로 바뀌어서 강화 단계를 다시 초기화
                    document.getElementById("itemImage").src = "rocket.jpg";
                    document.getElementById("itemName").innerHTML = "로켓";
                    successRate = 0.6; // 성공 확률 변경
                    failureRate = 0.4; // 실패 확률 변경
                    successRateElement.textContent = "성공 확률: 60%";
                    failureRateElement.textContent = "실패 확률: 40%";
                    successCountElement.innerHTML = "<span class='success-text'>로켓으로 변환!</span>";}
                  else if (document.getElementById("itemImage").src.includes("rocket.jpg")) 
                    {// 로켓이 +5로 강화됐을 때 핵으로 바뀌어서 강화 단계를 다시 초기화
                    document.getElementById("itemImage").src = "nuclear.jpg";
                    document.getElementById("itemName").innerHTML = "핵";
                    successRate = 0.5; // 성공 확률 변경
                    failureRate = 0.5; // 실패 확률 변경
                    successRateElement.textContent = "성공 확률: 50%";
                    failureRateElement.textContent = "실패 확률: 50%";
                    successCountElement.innerHTML = "<span class='success-text'>핵으로 변환!</span>";}
                  else if (document.getElementById("itemImage").src.includes("nuclear.jpg")) 
                  {// 핵이 +5로 강화됐을 때 풍선으로 바뀌고 강화하기 버튼 비활성화 및 텍스트 변경
                    document.getElementById("itemImage").src = "balloon.jpg";
                    document.getElementById("itemName").innerHTML = "";
                    successCountElement.innerHTML = "<span class='success-text'></span>";
                    enhanceButton.disabled = true;
                    enhanceButton.innerHTML = "축하합니다";
                    successRateElement.textContent = " ";
                    failureRateElement.textContent = " ";
                    enchanceRateElement.textContent = " ";}
                  successCount = 0; // 숫자 초기화
                }
              }
              // 별점과 코멘트를 저장할 배열
              var ratings = [];
                      var comments = [];
                      var maxCommentLength = 200;
              
                      // DOM 요소에 대한 참조
                      var commentInput = document.getElementById('comment');
                      var commentCountElement = document.getElementById('comment-count');
                      var averageRatingElement = document.getElementById('average-rating');
              
                      // 입력한 코멘트의 길이를 확인하고 제한을 적용하는 함수
                      function saveRatingAndComment() {
                          var comment = commentInput.value;
                          if (comment.trim().length === 0) {
                              alert('댓글을 입력하세요.');
                              return;
                          }
                          if (comment.length > maxCommentLength) {
                              alert('댓글은 최대 ' + maxCommentLength + '자까지 입력할 수 있습니다.');
                              return;
                          }
              
                          // 선택된 별점
                          var selectedRating = document.querySelector('input[name="rating"]:checked');
                          if (!selectedRating) {
                              alert('별점을 선택해주세요.');
                              return;
                          }
              
                          // 입력된 이름과 비밀번호
                          var name = document.getElementById('name').value;
                          var password = document.getElementById('password').value;
              
                          // 현재 시간
                          var currentTime = new Date();
                          var timeString = currentTime.toLocaleString();
              
                          // 별점과 코멘트를 배열에 저장
                          ratings.push(selectedRating.value);
                          comments.push({ name: name, comment: comment, password: password, time: timeString, rating: selectedRating.value });
              
                          // 저장된 별점과 코멘트를 표시
                          displayRatingsAndComments();
                          // 댓글 수 업데이트
                          updateCommentCount();
                          // 평균 별점 계산 및 표시
                          calculateAndDisplayAverageRating();
                      }
              
                      // 별점과 코멘트를 표시하는 함수
                      function displayRatingsAndComments() {
                          // 평균 별점 표시
                          var averageRating = calculateAverageRating();
                          averageRatingElement.innerHTML = '평균 별점: ' + '★'.repeat(parseInt(averageRating)) + '☆'.repeat(5 - parseInt(averageRating)) + ' (' + averageRating.toFixed(1) + '점)';
              
                          // 코멘트 목록 표시
                          var commentsList = document.getElementById('comments-list');
                          commentsList.innerHTML = '';
                          comments.forEach(function (comment, index) {
                              var li = document.createElement('li');
                              li.textContent = comment.name + ': ' + comment.comment + ' (' + comment.time + ')';
              
                              // 개별 댓글의 별점을 별표시로 변경
                              // 개별 댓글의 별점을 별표시로 변경
                              var ratingSpan = document.createElement('span');
                              ratingSpan.className = 'star';
                              ratingSpan.textContent = '★'.repeat(parseInt(comment.rating)) + '☆'.repeat(5 - parseInt(comment.rating));
              
              
                              var ratingNumber = document.createElement('span');
                              ratingNumber.textContent = '(' + comment.rating + '점)';
              
                              var editButton = document.createElement('button');
                              editButton.textContent = '수정';
                              editButton.onclick = function () {
                                  var newPassword = prompt('새로운 비밀번호를 입력하세요.');
                                  if (newPassword !== null && newPassword.trim() !== '') {
                                      comments[index].password = newPassword;
                                      alert('비밀번호가 변경되었습니다.');
                                  } else {
                                      alert('비밀번호를 입력하세요.');
                                  }
                              };
              
                              var deleteButton = document.createElement('button');
                              deleteButton.textContent = '삭제';
                              deleteButton.onclick = function () {
                                  var inputPassword = prompt('비밀번호를 입력하세요.');
                                  if (inputPassword === comments[index].password) {
                                      comments.splice(index, 1);
                                      alert('댓글이 삭제되었습니다.');
                                      displayRatingsAndComments();
                                      updateCommentCount();
                                      calculateAndDisplayAverageRating();
                                  } else {
                                      alert('비밀번호가 일치하지 않습니다.');
                                  }
                              };
              
                              li.appendChild(ratingSpan);
                              li.appendChild(ratingNumber);
                              li.appendChild(editButton);
                              li.appendChild(deleteButton);
              
                              commentsList.appendChild(li);
                          });
                      }
              
                      // 평균 별점 계산하는 함수
                      function calculateAverageRating() {
                          var totalRating = ratings.reduce(function (acc, rating) {
                              return acc + parseInt(rating);
                          }, 0);
                          return totalRating / ratings.length;
                      }
              
                      // 댓글 수 업데이트 함수
                      function updateCommentCount() {
                          commentCountElement.textContent = '(' + comments.length + ')';
                      }
  </script>



</body>
</html>
